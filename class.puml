// ...existing code...
@startuml Meetsphere_ClassDiagram

' Skin
skinparam classAttributeIconSize 0
skinparam linetype ortho

' Models (backend)
class User {
  +ObjectId _id
  +String name
  +String username
  +String passwordHash
  +Meeting[] activities
  +comparePassword(plain): boolean
  +save(): Promise
}

class Meeting {
  +ObjectId _id
  +String meetingCode
  +ObjectId hostId
  +ObjectId[] participants
  +Date createdAt
  +addParticipant(userId): void
  +removeParticipant(userId): void
}

' Backend controllers / services
class UserController {
  +handleRegister(data): Response
  +handleLogin(credentials): Response
  +getAllActivity(token): Activity[]
  +addToActivity(userId, meetingCode): void
}

class SocketManager {
  -Server io
  -Map connections
  +connect(io): void
  +handleJoinCall(socket, meetingCode): void
  +handleSignal(from, to, data): void
  +handleChatMessage(meetingCode, message, sender): void
  +handleDisconnect(socket): void
}

' Frontend
class App {
  +Routes routes
}

class AuthContext {
  -axios client
  +userData
  +handleRegister(...)
  +handleLogin(...)
  +getHistoryOfUser()
  +addToUserHistory(meetingCode)
}

class VideoMeetComponent {
  -Ref socketRef
  -Ref localVideoRef
  -Map connections
  +connect(meetingCode)
  +getPermissions()
  +handleVideoToggle()
  +handleAudioToggle()
  +sendMessage(text)
  +handleScreenShare()
}

class PeerConnectionManager {
  -Map connections
  +createPeerFor(id): RTCPeerConnection
  +addLocalStream(stream)
  +createOffer(id)
  +handleRemoteSignal(fromId, sdpOrIce)
}

' Relationships
User "1" -- "*" Meeting : activities
UserController ..> User : uses
UserController ..> Meeting : uses

SocketManager ..> Meeting : room management
SocketManager ..> User : may query
SocketManager ..> UserController : invokes

VideoMeetComponent ..> SocketManager : emits / listens
VideoMeetComponent ..> PeerConnectionManager : manages peers
VideoMeetComponent ..> AuthContext : reads userData / auth token
AuthContext ..> UserController : calls API (client)

App "1" o-- "1" AuthContext
App "1" o-- "1" VideoMeetComponent

PeerConnectionManager ..> RTCPeerConnection : wraps

@enduml
// ...existing code...